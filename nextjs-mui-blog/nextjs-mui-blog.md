# Introduction

In this tutorial, I will walk you through how to create a blog and portfolio website using Next.js and Material UI. This project is a lightweight, SEO-friendly, and highly customizable template that features dark mode support, token-based theming, a dynamic Table of Contents (TOC), code highlighting, and performance optimizations to achieve 90-100% Lighthouse scores.

# Next.js Setup

## Install Next.js

To get started we will install the latest Next.js version and create a new project:

```bash
npx create-next-app@latest nextjs-mui-blog-starter
```

When the installation starts, you will be prompted with a few questions. You can choose the default settings or customize them to your liking as long as you exlcude Tailwind CSS as we will be using Material UI for styling.

## Test Next.js

After the installation is complete, navigate to the project and run the following command to start and test the project:

```bash
cd nextjs-mui-blog-starter
npm run dev
```

We should now see the default Next.js landing page.

# Material UI Setup

## Install Material UI

Next, we will install Material UI and its dependencies:

```bash
npm install @mui/material @emotion/react @emotion/styled @mui/material-nextjs @emotion/cache
```

For styling, we will use the `@emotion/react` and `@emotion/styled` packages. The `@mui/material-nextjs` package is a custom server-side rendering (SSR) solution for Material UI that is optimized for Next.js.

## Configure Material UI

Now let's do some clean up and basic MUI addtions:

- Get rid of the `globals.css` file as we will be using Material UI's built-in CSS-in-JS solution
- Clean up `pagee.tsx` to remove the default content
- Make the following changes to the `layout.tsx` file:

```tsx
import { CssBaseline } from "@mui/material";
import { AppRouterCacheProvider } from "@mui/material-nextjs/v15-appRouter";

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <AppRouterCacheProvider>
          <CssBaseline />
          {children}
        </AppRouterCacheProvider>
      </body>
    </html>
  );
}
```

The `AppRouterCacheProvider` component is responsible for collecting the CSS generated by MUI System on the server, as Next.js is streaming chunks of the .html page to the client. (https://mui.com/material-ui/integrations/nextjs/)

`CSSBaseline` is a component that applies the baseline styles to the document, including the default font family, color, and background. (https://mui.com/components/css-baseline/)

At this point, you should have a clean project with white background and no default styles.

## Test Material UI

To test if Material UI is working correctly, let's create a simple `Header` component and import it into the `layout.tsx` file:

```tsx
import AppBar from "@mui/material/AppBar";
import Toolbar from "@mui/material/Toolbar";
import Typography from "@mui/material/Typography";
import Button from "@mui/material/Button";

export default function Header() {
  return (
    <AppBar position="static">
      <Toolbar>
        <Typography variant="h6" mr={5}>
          My Blog
        </Typography>
        <Button color="inherit">Home</Button>
        <Button color="inherit">Blog</Button>
        <Button color="inherit">About</Button>
      </Toolbar>
    </AppBar>
  );
}
```

```tsx {3, 15}
import { CssBaseline } from "@mui/material";
import { AppRouterCacheProvider } from "@mui/material-nextjs/v15-appRouter";
import Header from "./components/Header";

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <AppRouterCacheProvider>
          <CssBaseline />
          <Header />
          {children}
        </AppRouterCacheProvider>
      </body>
    </html>
  );
}
```

If you see the blue header with the "My Blog" title and navigation buttons, Material UI is set up correctly for you!

![Next.js and Material UI](./blog-header.png)

# MDX Setup

Now that we have Next.js and Material UI set up, let's create a blog post.

## Install dependencies

When writting a blog, the most common way to store the content is in Markdown or MDX format.

To process Markdown and MDX in NextJS, we need to install the following dependencies:

```bash
npm install @next/mdx @mdx-js/loader @mdx-js/react @types/mdx
```

## Configure `next.config.ts`

Then configure `next.config.ts` to allow `.md` and `.mdx` pages to be accessible by the router:

```ts
import withMdx from "@next/mdx";

const nextConfig = {
  pageExtensions: ["ts", "tsx", "js", "jsx", "mdx"],
};

const mdxConfig = {
  // Add plugins here
};

export default withMdx(mdxConfig)(nextConfig);
```

`nextMDX` is a plugin that allows you to use MDX files in your Next.js project. It automatically converts MDX files to React components and provides a way to render them in your application.

## Add an `mdx-components.tsx` file

Creating a `mdx-components.tsx` file is required as part of the configuration for MDX to work with the app router.

We can create one at the same level as the `app` folder with the following content:

```tsx
import type { MDXComponents } from "mdx/types";

export function useMDXComponents(components: MDXComponents): MDXComponents {
  return {
    ...components,
  };
}
```

## Create a test blog post

We will create a new folder called `blogs` in the `app` directory that will contain all our blog posts. Inside the `blogs` folder, create a new folder called `my-first-blog-post` with a `page.mdx` file that will contain the content of the blog post.

````mdx
# My First Blog Post

Welcome to my first blog post! In this post, I will share my journey of learning Next.js and Material UI. Stay tuned for more exciting content!

## Setup

To get started, we will install the latest Next.js version and create a new project:

```bash
npx create-next-app@latest nextjs-mui-blog-starter
```
````

Now, when navigating to `http://localhost:3000/blogs/my-first-blog-post`, you should see the content of the blog post.

Next JS app router is very powerful and can handle dynamic routes, nested routes, and more...(explain more). You can learn more about it [here](https://nextjs.org/docs/routing/introduction).

Here is the final project structure:

```plaintext
nextjs-mui-blog-starter
├── app
│   ├── blogs
│   │   └── my-first-blog-post
│   │       └── page.mdx
│   ├── components
│   │   └── Header.tsx
│   ├── layouts
│   │   └── layout.tsx
│   └── mdx-components.tsx
├── next.config.ts
├── package.json
└── tsconfig.json
```

# Adding Blog Features

Now that we have the basic setup ready, let's add some features to our blog.

## Dynamic routing

Next.js allows us to create dynamic routes by using square brackets `[]`.

Dynamic routing provides several advantage such as:

- Scalability for large content collections.
- Ability to manipulate the URL to filter and sort content.
- Manage shared metadata across multiple pages like title, description, and image.
- Create shared table of contents (TOC) for all blog posts.

Some of those features we are implementing in this tutorial so it's better to get you all sorted out as early as possible!

In Next.js, creating a folder with square brackets like `[slug]` inside the `blogs` folder, along with a `page.tsx` file inside [slug], is how you define a dynamic route in the `app` directory. Here’s how it works and why it enables dynamic routing:

- Square brackets ([slug]) indicate a dynamic segment. This tells Next.js that the content inside the brackets (slug) is a variable part of the URL.
- When a request comes in with a URL like /blogs/my-first-post, Next.js knows that the my-first-post portion of the URL should be treated as a parameter for the route defined by [slug].
- Next.js then passes the value of my-first-post to the page component as a prop, which you can use to fetch and render the content for that specific blog post.

Let's create the `[slug]` folder and `page.tsx` file with the following content:

```plaintext
nextjs-mui-blog-starter
├── app
│   ├── blogs
│   │   ├── [slug]
│   │   │   └── page.tsx
│   │   └── my-first-blog-post
│   │       └── page.mdx
```

```tsx
import { MDXRemote } from "next-mdx-remote";

export default function BlogPostPage({ params }: { params: { slug: string } }) {
  const { slug } = params;

  return (
    <div>
      <h1>Blog Post: {slug}</h1>
      {/* Render content based on slug */}
    </div>
  );
}
```
